define(["app/model/util","app/model/responsiveness","jquery","bootstrap"],function(t,e,i){function n(){var t,e,n,d=i(window),s=o.scrollTop(),c=0,l=0;o.find("main > article").find("section").each(function(){return t=i(this),t.offset().top>s?(e=a.find('a[href="#'+t.attr("id")+'"]'),n=e.parent("li"),a.data("oldActiveItems")&&a.data("oldActiveItems").removeClass("active"),a.data("oldActiveItems",e.parents("li").addClass("active")),l=e.offset().top,c=s+d.height()-l-e.height()-15,0>c?a.children("ul").css("top",c):s>l&&a.children("ul").css("top",s-l),!1):void 0})}if(!(i(window).width()<e.desktop.width)){var o=i(document),a=i('<nav class="col-lg-2 col-md-3 hidden-xs hidden-sm"/>');o.on("scroll.ui.an",function(){t.throttle(n)}).ready(function(){var t=o.find("main > article"),e=function(t){var n=i('<ul class="list-unstyled"/>'),o=i("<li/>"),a=t.children("h1,h2,h3,h4,h5,h6").text(),d="chapter-"+a.replace(/\W/g,"");return n.append(o),o.append(i("<a/>").attr("href","#"+d).text(a)),t.attr("id",d),t.children("section").each(function(){o.append(e(i(this)))}),n};t.children("section").each(function(){a.append(e(i(this).addClass("col-lg-10 col-md-9")))}).end().append(a),console.log(o.height()-t.offset().top-t.height()),a.children("ul").affix({offset:{top:a.offset().top,bottom:o.height()-t.offset().top-t.height()}}).on("affixed-top.bs.affix",function(){i(this).css("top","")}),n()})}});