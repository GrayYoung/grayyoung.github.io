define([],function(){function createXHR(){createXHR="undefined"!=typeof XMLHttpRequest?function(){return new XMLHttpRequest}:"undefined"!=typeof ActiveXObject?function(){if("string"!=typeof arguments.callee.activeXString)for(var versions=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],i=0,len=versions.length;len>i;i++)try{var xhr=new ActiveXObject(versions[i]);arguments.callee.activeXString=versions[i];return xhr}catch(error){console.log("Failed to create XMLHttpRequest: "+versions[i])}return new ActiveXObject(arguments.callee.activeXString)}:function(){throw new Error("No XHR object availabel.")};return createXHR()}return function(method,url,callback){var xhRequest=createXHR();if("undefined"!=typeof Uint8Array){xhRequest.responseType="arraybuffer";xhRequest.onload=function(e){for(var arraybuffer=xhRequest.response,data=new Uint8Array(arraybuffer),arr=new Array,i=0;i!=data.length;++i)arr[i]=String.fromCharCode(data[i]);callback(XLSX.read(arr.join(""),{type:"binary"}))}}else{xhRequest.setRequestHeader("Accept-Charset","x-user-defined");xhRequest.onreadystatechange=function(){4==xhRequest.readyState&&(xhRequest.status>=200&&xhRequest.status<=300||304==xhRequest.status?callback(XLSX.read(xhRequest.responseBody,{type:"binary"})):console.log("Request was unsuccessful: "+xhRequest.status))}}xhRequest.open(method,url,!0);xhRequest.send();return xhRequest}});