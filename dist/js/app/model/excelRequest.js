define([],function(){return function(method,url,callback){var xhRequest;if(window.XMLHttpRequest)xhRequest=new XMLHttpRequest;else{if(!window.ActiveXObject)throw"XHR unavailable for your browser";xhRequest=new ActiveXObject("MSXML2.XMLHTTP.3.0")}xhRequest.open(method,url,!0);if("undefined"!=typeof Uint8Array){xhRequest.responseType="arraybuffer";xhRequest.onload=function(e){for(var arraybuffer=xhRequest.response,data=new Uint8Array(arraybuffer),arr=new Array,i=0;i!=data.length;++i)arr[i]=String.fromCharCode(data[i]);callback(XLSX.read(arr.join(""),{type:"binary"}))}}else{xhRequest.setRequestHeader("Accept-Charset","x-user-defined");xhRequest.onreadystatechange=function(){4==xhRequest.readyState&&200==xhRequest.status&&callback(XLSX.read(xhRequest.responseBody,{type:"binary"}))}}xhRequest.send();return xhRequest}});